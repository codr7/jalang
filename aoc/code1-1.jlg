(function find-digit [line]
  (digit (head (find digit? line))))

(function decode-line [line]
  (head (parse-integer (string (find-digit line)
                               (find-digit (reverse-string line))))))

(function calibrate [input]
  (reduce + (map decode-line (split (slurp input) "\n")) 0))

(say (calibrate (path "input1")))